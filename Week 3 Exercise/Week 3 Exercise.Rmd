---
title: "Week 3 Exercise"
author: "Hui Jeong Jung"
date: "10/4/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data Import

```{r}
x = readRDS("counts.RDS")
anno = readRDS("phenodata.RDS")
head(anno)

```

## Compute and Visualize Basic Statistics
The following table shows how many replicates there are for each combination of factor levels. 
```{r}
table(anno$Treatment, anno$Technology)
```

The following code shows how many genes have an expression value greater than 0 in each sample. 
```{r}
factor1<-sum(x[,"bulk.DMSO-Pre-96IFC"] > 0)
factor2<-sum(x[,"bulk.TSA-Pre-96IFC"] > 0)
factor3<-sum(x[, "bulk.DMSO-Pre-800IFC"] > 0)
factor4<-sum(x[, "bulk.TSA-Pre-800IFC"] >0)
factor5<-sum(x[, "bulk.DMSO-Post-800IFC"] > 0)
factor6<-sum(x[, "bulk.TSA-Post-800IFC"] > 0)
tab <- matrix(c(factor1, factor2, factor3, factor4, factor5, factor6), ncol = 1)
rownames(tab) <- c('bulk.DMSO-Pre-96IFC', 'bulk.TSA-Pre-96IFC', 'bulk.DMSO-Pre-800IFC', 'bulk.TSA-Pre-800IFC', 'bulk.DMSO-Post-800IFC', 'bulk.TSA-Post-800IFC')
colnames(tab) <- c('Num of genes')
tab<-as.table(tab)
tab
```

## Normalize the data
```{r}

```

## Transform the data to log-scale

## Visualize the distribution of the expression values

## Most variable genes

## Sample correlations

## Clustering

## Heatmap 

## PCA


